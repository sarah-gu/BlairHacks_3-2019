(function($){var init=function(){$('.gva-interactive-map').each(function(index,element){var $map=$(element);var id=$map.attr('id');var markers_id=$map.attr('data-map-id');var map=L.map(id).setView([36.8282,-94.5795],4);L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png',{maxZoom:16,attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}).addTo(map);var markers=new L.MarkerClusterGroup();if(typeof(Drupal.settings.gva_interactive_map)==='undefined')return;var markers_raw=[];var marker_items=Drupal.settings.gva_interactive_map[markers_id].split('||');for(var marker_items_index in marker_items){if(!marker_items.hasOwnProperty(marker_items_index))continue;markers_raw.push(marker_items[marker_items_index].split('|'));}
for(var marker_index in markers_raw){if(!markers_raw.hasOwnProperty(marker_index))continue;markers.addLayer(L.marker([markers_raw[marker_index][0],markers_raw[marker_index][1]],{nid:markers_raw[marker_index][2]}));}
markers.on('click',function(a){if(typeof(a.layer.options.nid)!=='undefined'){var link='https://www.gunviolencearchive.org/incident/'+a.layer.options.nid;if(!a.layer.getPopup()){a.layer.bindPopup('<a href="'+link+'" target="_blank">View Incident</a>').togglePopup();}}});map.addLayer(markers);});};$(init);})(jQuery);